{% load static tailwind_tags %}
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Weaver{% endblock %}</title>
    {% block additional_head %} {% endblock %}
    {# favicon #}
    <link rel="icon" type="image/svg+xml" href="{% static 'img/mikihands-favicon.svg' %}">
    <link rel="icon" sizes="16x16" href="{% static 'img/mikihands-favicon-16.png' %}" type="image/png">
    <link rel="icon" sizes="32x32" href="{% static 'img/mikihands-favicon-32.png' %}" type="image/png">
    <link rel="icon" sizes="48x48" href="{% static 'img/mikihands-favicon-48.png' %}" type="image/png">
    <link rel="apple-touch-icon" sizes="180x180" href="{% static 'img/mikihands-favicon-180.png' %}">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f2f5;
        }
    </style>
    {% if not DEBUG_MODE %}
        {% tailwind_preload_css %}
    {% endif %}
    {% tailwind_css %}
</head>
<body class="flex flex-col min-h-screen">
    <!-- Navigation Bar -->
    <nav class="bg-white shadow-md p-4">
        <div class="container mx-auto flex justify-between items-center">
            <a href="{% url 'mybook:upload_page' %}" class="flex-shrink-0 flex items-center font-bold text-xl">
                📚 BookWeaver
            </a>
            <div>
                {% if user_logged_in %}
                    <div class="relative">
                        <button id="user-menu-button" class="flex items-center text-gray-600 hover:text-gray-900 focus:outline-none transition duration-300 text-sm font-medium">
                            <span>{{ user_profile.username }} 님</span>
                            <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                        </button>
                        <div id="user-menu" class="hidden absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-50 ring-1 ring-black ring-opacity-5">
                            <a href="{% url 'mybook:bookshelf' %}" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">내 서재</a>
                            <a href="{% url 'mybook:logout' %}" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">로그아웃</a>
                        </div>
                    </div>
                {% else %}
                    <div class="space-x-4">
                        <a href="{% url 'mybook:register_page' %}" class="text-gray-600 hover:text-gray-900 transition duration-300">회원가입</a>
                        <a href="{% url 'mybook:login_page' %}" class="text-gray-600 hover:text-gray-900 transition duration-300">로그인</a>
                    </div>
                {% endif %}
            </div>
        </div>
    </nav>

    <!-- Main Content Block -->
    <main class="flex-grow">
        {% block content %}
        {% endblock %}
    </main>

    <!-- Footer -->
    <footer class="bg-gray-900 text-gray-300 p-8 mt-auto">
        <div class="container mx-auto">
            <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-8">
                <div>
                    <h2 class="text-xl font-bold mb-2 text-white">Mikihands</h2>
                    <p class="text-sm">Terms & Policies</p>
                    <p class="text-sm">Privacy Policy</p>
                </div>
                <div>
                    <!-- Social Media Icons (placeholder) -->
                    <div class="flex space-x-4 text-white">
                        <a href="https://www.instagram.com/mikihands2024/"><img class="w-6 h-6" src="{% static 'img/jt-instagram.svg' %}" alt="Instagram"></a>
                        <a href="https://youtube.com/@mikihands?si=eoHNHtDi2ndNobIG/"><img class="w-6 h-6" src="{% static 'img/jt-youtube.svg' %}" alt="YouTube"></a>
                        <a href="https://x.com/mikihands156565/"><img class="w-6 h-6" src="{% static 'img/jt-twitter.svg' %}" alt="Twitter"></a>
                        <a href="https://www.facebook.com/profile.php?id=61566815865801/"><img class="w-6 h-6" src="{% static 'img/jt-facebook.svg' %}" alt="Facebook"></a>
                    </div>
                </div>
                <div class="md:col-span-2">
                    <p class="text-xs">Business No. 371-11-00780 | 대표자 김현기 / 통신판매신고번호 제2017- 서울서대문-0622</p>
                    <p class="text-xs">서울시 서대문구 수색로 100, 309-903</p>
                    <p class="text-xs">info@mikihands.com</p>
                    <p class="text-xs mt-4">Copyright 2023 Mikihands</p>
                </div>
            </div>
        </div>
    </footer>

    {% block extra_js %}{% endblock %}
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const userMenuButton = document.getElementById('user-menu-button');
            const userMenu = document.getElementById('user-menu');

            if (userMenuButton && userMenu) {
                userMenuButton.addEventListener('click', function() {
                    userMenu.classList.toggle('hidden');
                });

                // Close the dropdown if the user clicks outside of it
                window.addEventListener('click', function(event) {
                    if (!userMenuButton.contains(event.target) && !userMenu.contains(event.target)) {
                        userMenu.classList.add('hidden');
                    }
                });
            }
        });
    </script>
</body>
</html>
